(()=>{let e;let t={itemClass:"carousel-item",onItemChange:function(e,t){}},r={behavior:"smooth",block:"end",inline:"center"};function o(e,o){if(void 0!==e.carousel)return;o||(o=t);var n=Array.from(e.querySelectorAll(`.${o.itemClass}`));let a=e.querySelector("[data-nav=prev]"),i=e.querySelector("[data-nav=next]"),l=new IntersectionObserver(function(e){n.forEach(e=>{e.classList.remove("active")}),e.filter(e=>e.isIntersecting).forEach((e,t)=>{e.target.classList.add("active")})},{root:e,rootMargin:"0px",threshold:1});n.forEach((e,t)=>{l.observe(e)}),a&&a&&(a.style.opacity=.7,i.style.opacity=.7,0<n.length-1&&(i.style.opacity=1)),a&&a.addEventListener("click",function(e){}),i&&i.addEventListener("click",function(e){0<n.length-1&&(n[1].scrollIntoView(r),o.onItemChange(el,1))}),e.carousel=this}var n,a,i=document.querySelector("#search-query"),l=document.querySelector("#search-suggestions");(Videobox={followSeries:function(e,t,r){var o=new FormData;o.append("following",t),fetch(`/series/follow/${e}`,{method:"POST",body:o}).then(e=>{if(!e.ok)throw Error(`Server returned error ${e.status} while handling POST request`);e.text().then(e=>{r.target.outerHTML=e})})},suggest:(n=()=>{var e=i.value;e.length<3||fetch(`/suggest?query=${e}`).then(e=>{if(!e.ok)throw Error(`Server returned error ${e.status} while handling suggest query`);e.text().then(e=>{l.innerHTML=e})})},function(){let t=this,r=arguments,o=a&&!e;clearTimeout(e),e=setTimeout(()=>{e=null,a||n.apply(t,r)},200),o&&n.apply(t,r)}),update:function(){var e=this.openDialog(event,"#update-dialog");fetch("/update").then(e=>{if(!e.ok)throw Error(`Server returned error ${e.status} while handling update`)});var t=new EventSource("/update-events");t.addEventListener("updating",t=>{e.innerHTML=t.data}),t.addEventListener("done",r=>{e.innerHTML=r.data,t.close()}),t.addEventListener("error",e=>{t.close()})},openSearchDialog:function(e){i.value="",l.replaceChildren(),Videobox.openDialog(e,"#search-dialog")},openDialog:function(e,t){var r=document.querySelector(t);return r.showModal(),r.classList.add("in"),r.addEventListener("click",e=>{e.target===e.currentTarget&&e.currentTarget.close()}),r},loadReleaseInfo:function(e,t){var r=Videobox.openDialog(e,"#release-dialog");fetch(`/release/${t}`).then(e=>{if(!e.ok)throw Error(`Server returned error ${e.status} while handling request`);e.text().then(e=>{r.innerHTML=e})})},loadMore:function(e){var t=document.querySelector(".load-more-wrapper");fetch(e).then(e=>{if(!e.ok)throw Error(`Server returned error ${e.status} while handling tag pagination`);e.text().then(e=>{t.querySelector("button").remove();var r=document.createElement("template");r.innerHTML=e,t.appendChild(r.content.firstElementChild).scrollIntoView({behavior:"smooth",block:"start"})})})},setup:function(){Array.from(document.querySelectorAll(".carousel__items")).map(e=>new o(e,void 0))}}).setup()})();
//# sourceMappingURL=app.js.map
