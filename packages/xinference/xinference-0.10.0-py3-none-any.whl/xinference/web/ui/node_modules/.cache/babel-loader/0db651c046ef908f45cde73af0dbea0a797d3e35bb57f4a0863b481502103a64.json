{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{CssBaseline,ThemeProvider}from'@mui/material';import Snackbar from'@mui/material/Snackbar';import React,{useEffect,useState}from'react';import{useCookies}from'react-cookie';import{HashRouter,Route,Routes}from'react-router-dom';import{Alert}from'./components/alertComponent';import{ApiContextProvider}from'./components/apiContext';import AuthAlertDialog from'./components/authAlertDialog';import{getEndpoint,isValidBearerToken}from'./components/utils';import Layout from'./scenes/_layout';import ClusterInfo from'./scenes/cluster_info';import LaunchModel from'./scenes/launch_model';import Login from'./scenes/login/login';import RegisterModel from'./scenes/register_model';import RunningModels from'./scenes/running_models';import{useMode}from'./theme';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useMode=useMode(),_useMode2=_slicedToArray(_useMode,1),theme=_useMode2[0];var _useCookies=useCookies(['token']),_useCookies2=_slicedToArray(_useCookies,3),cookie=_useCookies2[0],setCookie=_useCookies2[1],removeCookie=_useCookies2[2];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),msg=_useState2[0],setMsg=_useState2[1];var endPoint=getEndpoint();var removeToken=function removeToken(){removeCookie('token',{path:'/'});};useEffect(function(){// token possible value: no_auth / need_auth / <real bearer token>\nfetch(endPoint+'/v1/cluster/auth',{method:'GET',headers:{'Content-Type':'application/json'}}).then(function(res){if(!res.ok){res.json().then(function(errorData){setMsg(\"Server error: \".concat(res.status,\" - \").concat(errorData.detail||'Unknown error'));});}else{res.json().then(function(data){if(data['auth']===false){if(cookie.token!=='no_auth'){setCookie('token','no_auth',{path:'/'});}}else{// TODO: validate bearer token\nif(cookie.token===undefined||!isValidBearerToken(cookie.token)){// not a bearer token, need a bearer token here\nsetCookie('token','need_auth',{path:'/'});}}});}});// return a function in useEffect means doing something on component unmount\nreturn function(){removeToken();};},[]);var handleClose=function handleClose(event,reason){if(reason==='clickaway'){return;}setMsg('');};return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(Snackbar,{open:msg!=='',autoHideDuration:10000,anchorOrigin:{vertical:'top',horizontal:'center'},onClose:handleClose,children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",onClose:handleClose,sx:{width:'100%'},children:msg})}),/*#__PURE__*/_jsx(HashRouter,{children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsxs(ApiContextProvider,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsx(AuthAlertDialog,{}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsxs(Route,{element:/*#__PURE__*/_jsx(Layout,{}),children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LaunchModel,{})}),/*#__PURE__*/_jsx(Route,{path:\"/running_models\",element:/*#__PURE__*/_jsx(RunningModels,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register_model\",element:/*#__PURE__*/_jsx(RegisterModel,{})}),/*#__PURE__*/_jsx(Route,{path:\"/cluster_info\",element:/*#__PURE__*/_jsx(ClusterInfo,{})})]})]})]})})})]});}export default App;","map":{"version":3,"names":["CssBaseline","ThemeProvider","Snackbar","React","useEffect","useState","useCookies","HashRouter","Route","Routes","Alert","ApiContextProvider","AuthAlertDialog","getEndpoint","isValidBearerToken","Layout","ClusterInfo","LaunchModel","Login","RegisterModel","RunningModels","useMode","jsx","_jsx","jsxs","_jsxs","App","_useMode","_useMode2","_slicedToArray","theme","_useCookies","_useCookies2","cookie","setCookie","removeCookie","_useState","_useState2","msg","setMsg","endPoint","removeToken","path","fetch","method","headers","then","res","ok","json","errorData","concat","status","detail","data","token","undefined","handleClose","event","reason","className","children","open","autoHideDuration","anchorOrigin","vertical","horizontal","onClose","severity","sx","width","element"],"sources":["/home/runner/work/inference/inference/xinference/web/ui/src/App.js"],"sourcesContent":["import { CssBaseline, ThemeProvider } from '@mui/material'\nimport Snackbar from '@mui/material/Snackbar'\nimport React, { useEffect, useState } from 'react'\nimport { useCookies } from 'react-cookie'\nimport { HashRouter, Route, Routes } from 'react-router-dom'\n\nimport { Alert } from './components/alertComponent'\nimport { ApiContextProvider } from './components/apiContext'\nimport AuthAlertDialog from './components/authAlertDialog'\nimport { getEndpoint, isValidBearerToken } from './components/utils'\nimport Layout from './scenes/_layout'\nimport ClusterInfo from './scenes/cluster_info'\nimport LaunchModel from './scenes/launch_model'\nimport Login from './scenes/login/login'\nimport RegisterModel from './scenes/register_model'\nimport RunningModels from './scenes/running_models'\nimport { useMode } from './theme'\n\nfunction App() {\n  const [theme] = useMode()\n  const [cookie, setCookie, removeCookie] = useCookies(['token'])\n  const [msg, setMsg] = useState('')\n\n  const endPoint = getEndpoint()\n\n  const removeToken = () => {\n    removeCookie('token', { path: '/' })\n  }\n\n  useEffect(() => {\n    // token possible value: no_auth / need_auth / <real bearer token>\n    fetch(endPoint + '/v1/cluster/auth', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    }).then((res) => {\n      if (!res.ok) {\n        res.json().then((errorData) => {\n          setMsg(\n            `Server error: ${res.status} - ${\n              errorData.detail || 'Unknown error'\n            }`\n          )\n        })\n      } else {\n        res.json().then((data) => {\n          if (data['auth'] === false) {\n            if (cookie.token !== 'no_auth') {\n              setCookie('token', 'no_auth', { path: '/' })\n            }\n          } else {\n            // TODO: validate bearer token\n            if (\n              cookie.token === undefined ||\n              !isValidBearerToken(cookie.token)\n            ) {\n              // not a bearer token, need a bearer token here\n              setCookie('token', 'need_auth', { path: '/' })\n            }\n          }\n        })\n      }\n    })\n    // return a function in useEffect means doing something on component unmount\n    return () => {\n      removeToken()\n    }\n  }, [])\n\n  const handleClose = (event, reason) => {\n    if (reason === 'clickaway') {\n      return\n    }\n    setMsg('')\n  }\n\n  return (\n    <div className=\"app\">\n      <Snackbar\n        open={msg !== ''}\n        autoHideDuration={10000}\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n        onClose={handleClose}\n      >\n        <Alert severity=\"error\" onClose={handleClose} sx={{ width: '100%' }}>\n          {msg}\n        </Alert>\n      </Snackbar>\n      <HashRouter>\n        <ThemeProvider theme={theme}>\n          <ApiContextProvider>\n            <CssBaseline />\n            <AuthAlertDialog />\n            <Routes>\n              <Route path=\"/login\" element={<Login />} />\n              <Route element={<Layout />}>\n                <Route path=\"/\" element={<LaunchModel />} />\n                <Route path=\"/running_models\" element={<RunningModels />} />\n                <Route path=\"/register_model\" element={<RegisterModel />} />\n                <Route path=\"/cluster_info\" element={<ClusterInfo />} />\n              </Route>\n            </Routes>\n          </ApiContextProvider>\n        </ThemeProvider>\n      </HashRouter>\n    </div>\n  )\n}\n\nexport default App\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}