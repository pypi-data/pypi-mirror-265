"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1838],{10048:(e,t,a)=>{var n=a(86326),i=a(35623),r=a(77940),c=a(36111),s=a(29079),o=a(97598),l=a.n(o),d=a(80841),m=a(58591),u=a(87597),y=a(99009),p=a(59865),g=a(96478),f=a(67599),D=a(49528),v=a(87493),b=a.n(v),h=a(54219),_=a(47279),E=a(49138);const j=l().shape({event_id:l().number,category_id:l().number}),O=l().shape({id:l().number,title:l().string,html:l().string,css:l().string,customFields:l().array,owner:l().shape({id:l().number,title:l().string,locator:l().object})}),w=l().shape({title:l().string.isRequired,version:l().number.isRequired});function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,c.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const A=s.Ay.bind(null,{endpoint:"receipts.add_default_template",rules:[{args:["event_id","object_type","template_name"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_name",isDynamic:!0}]},{args:["category_id","object_type","template_name"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_name",isDynamic:!0}]}]},"/"),C=s.Ay.bind(null,{endpoint:"receipts.add_template_page",rules:[{args:["event_id","object_type"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1}]},{args:["category_id","object_type"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1}]}]},"/"),R=s.Ay.bind(null,{endpoint:"receipts.clone_template",rules:[{args:["event_id","object_type","template_id"],converters:{event_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"clone",isDynamic:!1}]},{args:["category_id","object_type","template_id"],converters:{category_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"clone",isDynamic:!1}]}]},"/"),S=s.Ay.bind(null,{endpoint:"receipts.delete_template",rules:[{args:["event_id","object_type","template_id"],converters:{event_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]},{args:["category_id","object_type","template_id"],converters:{category_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),I=s.Ay.bind(null,{endpoint:"receipts.template",rules:[{args:["event_id","object_type","template_id"],converters:{event_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]},{args:["category_id","object_type","template_id"],converters:{category_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),M=s.Ay.bind(null,{endpoint:"receipts.template_list",rules:[{args:["event_id","object_type"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1}]},{args:["category_id","object_type"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),L=s.Ay.bind(null,{endpoint:"receipts.template_preview",rules:[{args:["event_id","object_type","template_id"],converters:{event_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"preview-template",isDynamic:!1}]},{args:["category_id","object_type","template_id"],converters:{category_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"preview-template",isDynamic:!1}]}]},"/");function k(e){let{template:{id:t,type:a,title:i,owner:r},dispatch:c,setDeletePrompt:s,targetLocator:o,inherited:l}=e;const d={receipt:{color:"red",text:g.Translate.string("Receipt")},certificate:{color:"blue",text:g.Translate.string("Certificate")}}[a];return n.createElement("tr",null,n.createElement("td",{className:"i-table id-column"},n.createElement("i",{className:"icon-agreement"})),n.createElement("td",null,i,d&&n.createElement(h.A,{size:"small",style:{marginLeft:"1em"},color:d.color,basic:!0},d.text)),n.createElement("td",{className:"text-superfluous"},l&&n.createElement(g.Translate,null,"from category"," ",n.createElement(g.Param,{name:"title",value:r.title,wrapper:n.createElement("a",{href:M(r.locator)})}))),n.createElement("td",{className:"receipts-client-js-templates-___TemplateListPane-module__template-actions___Tdv2v"},n.createElement("div",{className:"thin toolbar right"},n.createElement("a",{href:L(P({template_id:t},o))},n.createElement(_.A,{name:"eye",color:"blue",title:g.Translate.string("Preview template")})),!l&&n.createElement(m.Link,{to:I(P({template_id:t},o)),onClick:e=>e.target.dispatchEvent(new Event("indico:closeAutoTooltip"))},n.createElement(_.A,{name:"edit",color:"blue",title:g.Translate.string("Edit template")})),n.createElement(_.A,{name:"clone",color:"blue",title:g.Translate.string("Clone template"),onClick:e=>{e.target.dispatchEvent(new Event("indico:closeAutoTooltip")),(async()=>{try{const{data:e}=await D.indicoAxios.post(R(P({template_id:t},o)));c({type:"ADD_TEMPLATE",template:e})}catch(e){(0,D.handleAxiosError)(e)}})()}}),!l&&s&&n.createElement(_.A,{name:"trash",color:"red",title:g.Translate.string("Delete template"),onClick:e=>{e.target.dispatchEvent(new Event("indico:closeAutoTooltip")),s({title:i,func:()=>(async()=>{try{await D.indicoAxios.delete(S(P({template_id:t},o))),c({type:"DELETE_TEMPLATE",id:t})}catch(e){return(0,D.handleAxiosError)(e),!0}})()})}}))))}function x(e){let{ownTemplates:t,inheritedTemplates:a,defaultTemplates:i,targetLocator:r,dispatch:c}=e;const[s,o]=(0,n.useState)(null);return n.createElement(n.Fragment,null,n.createElement(y.RequestConfirmDelete,{onClose:()=>o(null),requestFunc:(null==s?void 0:s.func)||(()=>null),open:null!==s},n.createElement(g.Translate,null,"Are you sure you want to delete the template"," ",n.createElement(g.Param,{name:"template",value:null==s?void 0:s.title,wrapper:n.createElement("strong",null)}),"?")),!!a.length&&n.createElement("section",null,n.createElement("h3",null,n.createElement(g.Translate,null,"Inherited templates")),n.createElement("table",{className:"i-table-widget"},n.createElement("tbody",null,b()(a,"title").map((e=>n.createElement(k,{key:e.id,template:e,dispatch:c,targetLocator:r,inherited:!0})))))),n.createElement("section",{className:"custom-template-list"},n.createElement("div",{className:"flexrow f-a-center f-j-space-between"},n.createElement("h3",null,n.createElement(g.Translate,null,"Custom templates")),n.createElement(E.A,{button:!0,labeled:!0,title:g.Translate.string("Add a new template"),icon:"plus",text:g.Translate.string("Add new"),className:"mini primary icon",direction:"left"},n.createElement(E.A.Menu,null,n.createElement(E.A.Item,{as:m.Link,to:C(r),text:g.Translate.string("Blank template")}),b()(Object.entries(i),(e=>{let[,t]=e;return t.title})).map((e=>{let[t,{title:a,version:i}]=e;return n.createElement(E.A.Item,{key:t,as:m.Link,to:A(P(P({},r),{},{template_name:t})),text:`${a} (v${i})`})}))))),t.length?n.createElement("table",{className:"i-table-widget"},n.createElement("tbody",null,b()(t,"title").map((e=>n.createElement(k,{key:e.id,template:e,dispatch:c,setDeletePrompt:o,targetLocator:r}))))):n.createElement("div",{className:"italic text-not-important"},n.createElement(g.Translate,null,"No templates"))))}k.propTypes={template:O.isRequired,dispatch:l().func.isRequired,setDeletePrompt:l().func,targetLocator:j.isRequired,inherited:l().bool},k.defaultProps={inherited:!1,setDeletePrompt:null},x.propTypes={ownTemplates:l().arrayOf(O).isRequired,inheritedTemplates:l().arrayOf(O).isRequired,defaultTemplates:l().objectOf(w).isRequired,dispatch:l().func.isRequired,targetLocator:j.isRequired};var q=a(68373),N=a.n(q),F=a(52379),V=a(57427),B=a(45423),U=a(78434),z=a.n(U);function H(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function $(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function G(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$(Object(a),!0).forEach((function(t){H(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function K(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){Y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function J(e){return function t(){for(var a=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(a,[].concat(i,n))}}}function Z(e){return{}.toString.call(e).includes("Object")}function ee(e){return"function"==typeof e}var te=J((function(e,t){throw new Error(e[t]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),ae={changes:function(e,t){return Z(t)||te("changeType"),Object.keys(t).some((function(t){return a=e,n=t,!Object.prototype.hasOwnProperty.call(a,n);var a,n}))&&te("changeField"),t},selector:function(e){ee(e)||te("selectorType")},handler:function(e){ee(e)||Z(e)||te("handlerType"),Z(e)&&Object.values(e).some((function(e){return!ee(e)}))&&te("handlersType")},initial:function(e){var t;e||te("initialIsRequired"),Z(e)||te("initialType"),t=e,Object.keys(t).length||te("initialContent")}};function ne(e,t){return ee(t)?t(e.current):t}function ie(e,t){return e.current=X(X({},e.current),t),t}function re(e,t,a){return ee(t)?t(e.current):Object.keys(a).forEach((function(a){var n;return null===(n=t[a])||void 0===n?void 0:n.call(t,e.current[a])})),a}const ce={create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ae.initial(e),ae.handler(t);var a={current:e},n=J(re)(a,t),i=J(ie)(a),r=J(ae.changes)(e),c=J(ne)(a);return[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return ae.selector(e),e(a.current)},function(e){!function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}(n,i,r,c)(e)}]}};const se={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};const oe=function(e){return{}.toString.call(e).includes("Object")};var le={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},de=function(e){return function t(){for(var a=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(a,[].concat(i,n))}}}((function(e,t){throw new Error(e[t]||e.default)}))(le),me={config:function(e){return e||de("configIsRequired"),oe(e)||de("configType"),e.urls?(console.warn(le.deprecation),{paths:{vs:e.urls.monacoBase}}):e}};const ue=me;const ye=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}};const pe=function e(t,a){return Object.keys(a).forEach((function(n){a[n]instanceof Object&&t[n]&&Object.assign(a[n],e(t[n],a[n]))})),G(G({},t),a)};var ge={type:"cancelation",msg:"operation is manually canceled"};const fe=function(e){var t=!1,a=new Promise((function(a,n){e.then((function(e){return t?n(ge):a(e)})),e.catch(n)}));return a.cancel=function(){return t=!0},a};var De,ve,be=ce.create({config:se,isInitialized:!1,resolve:null,reject:null,monaco:null}),he=(ve=2,function(e){if(Array.isArray(e))return e}(De=be)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var a=[],n=!0,i=!1,r=void 0;try{for(var c,s=e[Symbol.iterator]();!(n=(c=s.next()).done)&&(a.push(c.value),!t||a.length!==t);n=!0);}catch(e){i=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return a}}(De,ve)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?W(e,t):void 0}}(De,ve)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),_e=he[0],Ee=he[1];function je(e){return document.body.appendChild(e)}function Oe(e){var t,a,n=_e((function(e){return{config:e.config,reject:e.reject}})),i=(t="".concat(n.config.paths.vs,"/loader.js"),a=document.createElement("script"),t&&(a.src=t),a);return i.onload=function(){return e()},i.onerror=n.reject,i}function we(){var e=_e((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],(function(t){Te(t),e.resolve(t)}),(function(t){e.reject(t)}))}function Te(e){_e().monaco||Ee({monaco:e})}var Pe=new Promise((function(e,t){return Ee({resolve:e,reject:t})})),Ae={config:function(e){var t=ue.config(e),a=t.monaco,n=K(t,["monaco"]);Ee((function(e){return{config:pe(e.config,n),monaco:a}}))},init:function(){var e=_e((function(e){return{monaco:e.monaco,isInitialized:e.isInitialized,resolve:e.resolve}}));if(!e.isInitialized){if(Ee({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),fe(Pe);if(window.monaco&&window.monaco.editor)return Te(window.monaco),e.resolve(window.monaco),fe(Pe);ye(je,Oe)(we)}return fe(Pe)},__getMonacoInstance:function(){return _e((function(e){return e.monaco}))}};const Ce=Ae;var Re={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Se={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}};var Ie=function({children:e}){return n.createElement("div",{style:Se.container},e)};var Me=function({width:e,height:t,isEditorReady:a,loading:i,_ref:r,className:c,wrapperProps:s}){return n.createElement("section",{style:{...Re.wrapper,width:e,height:t},...s},!a&&n.createElement(Ie,null,i),n.createElement("div",{ref:r,style:{...Re.fullWidth,...!a&&Re.hide},className:c}))},Le=(0,n.memo)(Me);var ke=function(e){(0,n.useEffect)(e,[])};var xe=function(e,t,a=!0){let i=(0,n.useRef)(!0);(0,n.useEffect)(i.current||!a?()=>{i.current=!1}:e,t)};function qe(){}function Ne(e,t,a,n){return function(e,t){return e.editor.getModel(Fe(e,t))}(e,n)||function(e,t,a,n){return e.editor.createModel(t,a,n?Fe(e,n):void 0)}(e,t,a,n)}function Fe(e,t){return e.Uri.parse(t)}var Ve=function({original:e,modified:t,language:a,originalLanguage:i,modifiedLanguage:r,originalModelPath:c,modifiedModelPath:s,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:l=!1,theme:d="light",loading:m="Loading...",options:u={},height:y="100%",width:p="100%",className:g,wrapperProps:f={},beforeMount:D=qe,onMount:v=qe}){let[b,h]=(0,n.useState)(!1),[_,E]=(0,n.useState)(!0),j=(0,n.useRef)(null),O=(0,n.useRef)(null),w=(0,n.useRef)(null),T=(0,n.useRef)(v),P=(0,n.useRef)(D),A=(0,n.useRef)(!1);ke((()=>{let e=Ce.init();return e.then((e=>(O.current=e)&&E(!1))).catch((e=>"cancelation"!==e?.type&&console.error("Monaco initialization: error:",e))),()=>j.current?function(){let e=j.current?.getModel();o||e?.original?.dispose(),l||e?.modified?.dispose(),j.current?.dispose()}():e.cancel()})),xe((()=>{if(j.current&&O.current){let t=j.current.getOriginalEditor(),n=Ne(O.current,e||"",i||a||"text",c||"");n!==t.getModel()&&t.setModel(n)}}),[c],b),xe((()=>{if(j.current&&O.current){let e=j.current.getModifiedEditor(),n=Ne(O.current,t||"",r||a||"text",s||"");n!==e.getModel()&&e.setModel(n)}}),[s],b),xe((()=>{let e=j.current.getModifiedEditor();e.getOption(O.current.editor.EditorOption.readOnly)?e.setValue(t||""):t!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),e.pushUndoStop())}),[t],b),xe((()=>{j.current?.getModel()?.original.setValue(e||"")}),[e],b),xe((()=>{let{original:e,modified:t}=j.current.getModel();O.current.editor.setModelLanguage(e,i||a||"text"),O.current.editor.setModelLanguage(t,r||a||"text")}),[a,i,r],b),xe((()=>{O.current?.editor.setTheme(d)}),[d],b),xe((()=>{j.current?.updateOptions(u)}),[u],b);let C=(0,n.useCallback)((()=>{if(!O.current)return;P.current(O.current);let n=Ne(O.current,e||"",i||a||"text",c||""),o=Ne(O.current,t||"",r||a||"text",s||"");j.current?.setModel({original:n,modified:o})}),[a,t,r,e,i,c,s]),R=(0,n.useCallback)((()=>{!A.current&&w.current&&(j.current=O.current.editor.createDiffEditor(w.current,{automaticLayout:!0,...u}),C(),O.current?.editor.setTheme(d),h(!0),A.current=!0)}),[u,d,C]);return(0,n.useEffect)((()=>{b&&T.current(j.current,O.current)}),[b]),(0,n.useEffect)((()=>{!_&&!b&&R()}),[_,b,R]),n.createElement(Le,{width:p,height:y,isEditorReady:b,loading:m,_ref:w,className:g,wrapperProps:f})};(0,n.memo)(Ve);var Be=function(e){let t=(0,n.useRef)();return(0,n.useEffect)((()=>{t.current=e}),[e]),t.current},Ue=new Map;var ze=function({defaultValue:e,defaultLanguage:t,defaultPath:a,value:i,language:r,path:c,theme:s="light",line:o,loading:l="Loading...",options:d={},overrideServices:m={},saveViewState:u=!0,keepCurrentModel:y=!1,width:p="100%",height:g="100%",className:f,wrapperProps:D={},beforeMount:v=qe,onMount:b=qe,onChange:h,onValidate:_=qe}){let[E,j]=(0,n.useState)(!1),[O,w]=(0,n.useState)(!0),T=(0,n.useRef)(null),P=(0,n.useRef)(null),A=(0,n.useRef)(null),C=(0,n.useRef)(b),R=(0,n.useRef)(v),S=(0,n.useRef)(),I=(0,n.useRef)(i),M=Be(c),L=(0,n.useRef)(!1),k=(0,n.useRef)(!1);ke((()=>{let e=Ce.init();return e.then((e=>(T.current=e)&&w(!1))).catch((e=>"cancelation"!==e?.type&&console.error("Monaco initialization: error:",e))),()=>P.current?(S.current?.dispose(),y?u&&Ue.set(c,P.current.saveViewState()):P.current.getModel()?.dispose(),void P.current.dispose()):e.cancel()})),xe((()=>{let n=Ne(T.current,e||i||"",t||r||"",c||a||"");n!==P.current?.getModel()&&(u&&Ue.set(M,P.current?.saveViewState()),P.current?.setModel(n),u&&P.current?.restoreViewState(Ue.get(c)))}),[c],E),xe((()=>{P.current?.updateOptions(d)}),[d],E),xe((()=>{!P.current||void 0===i||(P.current.getOption(T.current.editor.EditorOption.readOnly)?P.current.setValue(i):i!==P.current.getValue()&&(k.current=!0,P.current.executeEdits("",[{range:P.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),P.current.pushUndoStop(),k.current=!1))}),[i],E),xe((()=>{let e=P.current?.getModel();e&&r&&T.current?.editor.setModelLanguage(e,r)}),[r],E),xe((()=>{void 0!==o&&P.current?.revealLine(o)}),[o],E),xe((()=>{T.current?.editor.setTheme(s)}),[s],E);let x=(0,n.useCallback)((()=>{if(A.current&&T.current&&!L.current){R.current(T.current);let n=c||a,l=Ne(T.current,i||e||"",t||r||"",n||"");P.current=T.current?.editor.create(A.current,{model:l,automaticLayout:!0,...d},m),u&&P.current.restoreViewState(Ue.get(n)),T.current.editor.setTheme(s),void 0!==o&&P.current.revealLine(o),j(!0),L.current=!0}}),[e,t,a,i,r,c,d,m,u,s,o]);return(0,n.useEffect)((()=>{E&&C.current(P.current,T.current)}),[E]),(0,n.useEffect)((()=>{!O&&!E&&x()}),[O,E,x]),I.current=i,(0,n.useEffect)((()=>{E&&h&&(S.current?.dispose(),S.current=P.current?.onDidChangeModelContent((e=>{k.current||h(P.current.getValue(),e)})))}),[E,h]),(0,n.useEffect)((()=>{if(E){let e=T.current.editor.onDidChangeMarkers((e=>{let t=P.current.getModel()?.uri;if(t&&e.find((e=>e.path===t.path))){let e=T.current.editor.getModelMarkers({resource:t});_?.(e)}}));return()=>{e?.dispose()}}return()=>{}}),[E,_]),n.createElement(Le,{width:p,height:g,isEditorReady:E,loading:l,_ref:A,className:f,wrapperProps:D})},He=(0,n.memo)(ze),$e=a(5101),Ge=a(42430),Ke=a(6423),We=a(56237),Ye=a(99323),Qe=a(23507),Xe=a(89152),Je=a(39023);function Ze(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function et(e){let{children:t,target:a,overrides:i,open:r}=e;const[s,o]=(0,n.useState)(null),l=(0,n.useRef)(null),d=(0,n.useRef)(null),m=(0,n.useCallback)((e=>{if(d.current=e,e&&r){const t=e.getBoundingClientRect();l.current=t,o(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(a),!0).forEach((function(t){(0,c.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ze(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({position:"absolute",left:t.x+window.scrollX,top:t.y+window.scrollY,width:t.width,height:t.height},i))}}),[i,r]);return(0,n.useEffect)((()=>{if(!d.current||!r)return;const e=setInterval((()=>{if(!d.current)return;const e=d.current.getBoundingClientRect();var t,a;l.current&&(t=e,a=l.current,t.x!==a.x||t.y!==a.y||t.width!==a.width||t.height!==a.height)&&m(d.current)}),100);return()=>clearInterval(e)}),[d,m,r]),n.createElement(n.Fragment,null,n.createElement("div",{ref:m,style:{display:r?"block":"none"}},a),n.createElement(Je.A,{open:null!==s&&r},n.createElement("div",{style:s},t)))}et.propTypes={children:l().node.isRequired,target:l().node.isRequired,overrides:l().object,open:l().bool},et.defaultProps={overrides:{},open:!1};function tt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function at(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(a),!0).forEach((function(t){(0,c.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const nt=s.Ay.bind(null,{endpoint:"receipts.template_list",rules:[{args:["event_id","object_type"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1}]},{args:["category_id","object_type"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");Ce.config({monaco:$e});const it={html:{syntax:"html",fileName:"template.html"},css:{syntax:"css",fileName:"theme.css"},yaml:{syntax:"yaml",fileName:"metadata.yaml"}};function rt(e){let{template:t,onChange:a,onSubmit:i,editorHeight:r,targetLocator:c,loading:s,add:o}=e;const[l,d]=(0,n.useState)("html"),y=N()(t,["html","css","yaml"]),p=(0,n.useRef)(null);return(0,n.useEffect)((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),[l]),n.createElement(Ge.Form,{onSubmit:i,initialValues:at({title:(null==t?void 0:t.title)||null,default_filename:(null==t?void 0:t.default_filename)||""},y),initialValuesEqual:z()},(e=>{let{handleSubmit:i,values:y}=e;return n.createElement(Ke.A,{onSubmit:i,subscription:{dirty:!0}},n.createElement(Ge.FormSpy,{subscription:{dirtyFieldsSinceLastSubmit:!0}},(e=>{let{dirtyFieldsSinceLastSubmit:a}=e;return(!!t.owner||Object.values(a).some((e=>e)))&&n.createElement(Xe.FinalUnloadPrompt,{router:!0})})),n.createElement(Ke.A.Group,{widths:"equal"},n.createElement(Xe.FinalInput,{name:"title",label:g.Translate.string("Title"),type:"text",disabled:s,required:!0,rows:24}),n.createElement(Xe.FinalInput,{name:"default_filename",label:g.Translate.string("Default filename"),type:"text",componentLabel:"-{n}.pdf",labelPosition:"right",format:Xe.formatters.slugify,disabled:s,formatOnBlur:!0})),n.createElement(We.A.Group,{attached:"top"},["html","css","yaml"].map((e=>n.createElement(We.A,{type:"button",primary:e===l,key:e,onClick:()=>d(e)},it[e].fileName)))),["html","css","yaml"].map((e=>n.createElement(Xe.FinalField,{key:e,name:e,initialValue:t[e],parse:e=>e},(t=>{let{input:c,meta:o}=t;return n.createElement(n.Fragment,null,n.createElement(et,{target:n.createElement("div",{style:{height:`${r}px`,width:"100%"}}),open:e===l},s?n.createElement(V.A,{style:{height:`${r}px`},className:"receipts-client-js-templates-___Editor-module__loading-segment___jWKQs"},n.createElement(Ye.A,{active:!0},n.createElement(Qe.A,null))):n.createElement(He,{height:`${r}px`,theme:"vs-dark",path:it[e].fileName,defaultLanguage:it[e].syntax,value:c.value,onChange:t=>{a(at(at({},y),{},{[e]:t})),c.onChange(t)},onMount:(e,t)=>{p.current=e,e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyS,i)},options:{minimap:{enabled:!1}}})),n.createElement(u.A,{error:!0,visible:!!o.submitError},o.submitError))})))),n.createElement(Ke.A.Group,{className:"receipts-client-js-templates-___Editor-module__buttons___L50a6"},n.createElement(Xe.FinalSubmitButton,{label:g.Translate.string("Save"),disabledUntilChange:!o}),n.createElement(m.Link,{to:nt(c),className:"ui button"},n.createElement(g.Translate,null,"Cancel"))))}))}rt.propTypes={template:O.isRequired,onChange:l().func.isRequired,onSubmit:l().func.isRequired,editorHeight:l().number.isRequired,targetLocator:j.isRequired,loading:l().bool,add:l().bool},rt.defaultProps={loading:!1,add:!1};var ct=a(60638);function st(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}const ot=s.Ay.bind(null,{endpoint:"receipts.images",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"images",isDynamic:!1}]}]},"/"),lt=s.Ay.bind(null,{endpoint:"receipts.template_live_preview",rules:[{args:["event_id","object_type"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"live-preview",isDynamic:!1}]},{args:["category_id","object_type"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"live-preview",isDynamic:!1}]}]},"/");function dt(e){let{template:t,onSubmit:a,targetLocator:i,editorHeight:r,add:s,loading:o}=e;const[l,d]=(0,n.useState)({});return(0,n.useEffect)((()=>{d(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?st(Object(a),!0).forEach((function(t){(0,c.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):st(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({title:t.title},N()(t,["html","css","yaml"])))}),[t]),n.createElement(n.Fragment,null,n.createElement(y.ManagementPageSubTitle,{title:s?g.Translate.string("Add document template"):g.Translate.string("Edit document template")}),n.createElement(F.A,{columns:2,divided:!0},n.createElement(F.A.Row,null,n.createElement(F.A.Column,null,n.createElement(rt,{onSubmit:a,template:t,editorHeight:r,targetLocator:i,onChange:d,loading:o,add:s})),n.createElement(F.A.Column,null,l.html&&l.html.length>=3?n.createElement(ct.A,{url:lt(i),data:l,fetchImagesURL:"event_id"in i?ot(i):null}):n.createElement(V.A,{placeholder:!0},n.createElement(B.A,{icon:!0},n.createElement(_.A,{name:"eye"}),n.createElement(g.Translate,null,"Start writing a template to see the preview here...")))))))}function mt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ut(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(a),!0).forEach((function(t){(0,c.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):mt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}dt.propTypes={onSubmit:l().func.isRequired,template:O,targetLocator:j.isRequired,editorHeight:l().number,add:l().bool,loading:l().bool},dt.defaultProps={template:{html:"",css:"",yaml:""},editorHeight:800,add:!1,loading:!1};const yt=s.Ay.bind(null,{endpoint:"receipts.add_default_template",rules:[{args:["event_id","object_type","template_name"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_name",isDynamic:!0}]},{args:["category_id","object_type","template_name"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_name",isDynamic:!0}]}]},"/"),pt=s.Ay.bind(null,{endpoint:"receipts.add_template",rules:[{args:["event_id","object_type"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1}]},{args:["category_id","object_type"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"add",isDynamic:!1}]}]},"/"),gt=s.Ay.bind(null,{endpoint:"receipts.edit_template",rules:[{args:["event_id","object_type","template_id"],converters:{event_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]},{args:["category_id","object_type","template_id"],converters:{category_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),ft=s.Ay.bind(null,{endpoint:"receipts.get_default_template",rules:[{args:["template_name"],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"default-templates",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_name",isDynamic:!0}]}]},"/"),Dt=s.Ay.bind(null,{endpoint:"receipts.template",rules:[{args:["event_id","object_type","template_id"],converters:{event_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]},{args:["category_id","object_type","template_id"],converters:{category_id:"IntegerConverter",template_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"template_id",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),vt=s.Ay.bind(null,{endpoint:"receipts.template_list",rules:[{args:["event_id","object_type"],converters:{event_id:"IntegerConverter"},defaults:{object_type:"event"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1}]},{args:["category_id","object_type"],converters:{category_id:"IntegerConverter"},defaults:{object_type:"category"},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"receipts",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),bt=l().shape({event_id:l().number,category_id:l().number});function ht(e,t){switch(t.type){case"ADD_TEMPLATE":return ut(ut({},e),{},{ownTemplates:[...e.ownTemplates,t.template],message:g.Translate.string('Template "{title}" was added',{title:t.template.title})});case"UPDATE_TEMPLATE":return ut(ut({},e),{},{ownTemplates:e.ownTemplates.map((e=>e.id===t.id?ut(ut({},e),t.changes):e)),message:g.Translate.string('Template "{title}" was updated',{title:t.changes.title})});case"DELETE_TEMPLATE":return ut(ut({},e),{},{ownTemplates:e.ownTemplates.filter((e=>e.id!==t.id)),message:g.Translate.string("Template deleted")});case"RESET_MESSAGE":return ut(ut({},e),{},{message:null});default:return e}}function _t(e){let{templates:t,dispatch:a,targetLocator:i}=e;const r=(0,f.Uf)("template_id");return n.createElement(n.Fragment,null,n.createElement(y.ManagementPageBackButton,{url:vt(i)}),n.createElement(dt,{targetLocator:i,template:t.find((e=>e.id===r)),onSubmit:async e=>{try{await D.indicoAxios.patch(gt(ut({template_id:r},i)),e),a({type:"UPDATE_TEMPLATE",id:r,changes:e})}catch({response:{data:{webargs_errors:e}}}){return e}}}))}function Et(e){let{dispatch:t,targetLocator:a,defaultTemplate:i}=e;const r=(0,d.useHistory)(),{data:c,loading:s}=(0,p.Ku)({url:i&&ft({template_name:i})},{manual:!i});return n.createElement(n.Fragment,null,n.createElement(y.ManagementPageBackButton,{url:vt(a)}),n.createElement(dt,{onSubmit:async e=>{try{const{data:n}=await D.indicoAxios.post(pt(a),e);t({type:"ADD_TEMPLATE",template:n}),r.push(vt(a))}catch({response:{data:{webargs_errors:e}}}){return e}},targetLocator:a,template:c||void 0,loading:s,add:!0}))}function jt(e){let{initialState:t,defaultTemplates:a,targetLocator:i}=e;const[c,s]=(0,n.useReducer)(ht,t),o=Object.keys(i);return(0,n.useEffect)((()=>{c.message&&setTimeout((()=>s({type:"RESET_MESSAGE"})),2500)}),[c.message]),n.createElement(n.Fragment,null,c.message&&n.createElement(u.A,{success:!0},n.createElement(u.A.Content,null,c.message)),n.createElement(m.BrowserRouter,null,n.createElement(d.Switch,null,n.createElement(d.Route,{exact:!0,path:(0,f.kA)(pt,o),render:()=>n.createElement(Et,{dispatch:s,targetLocator:i})}),n.createElement(d.Route,{exact:!0,path:(0,f.kA)(yt,[...o,"template_name"]),render:e=>{let{match:{params:{template_name:t}}}=e;return n.createElement(Et,{dispatch:s,targetLocator:i,defaultTemplate:t})}}),n.createElement(d.Route,{exact:!0,path:[(0,f.kA)(Dt,[...o,"template_id"])],render:()=>n.createElement(_t,{templates:c.ownTemplates,dispatch:s,targetLocator:i})}),n.createElement(d.Route,{exact:!0,path:(0,f.kA)(vt,o),render:()=>n.createElement(x,(0,r.A)({dispatch:s,defaultTemplates:a,targetLocator:i},c))}))))}_t.propTypes={dispatch:l().func.isRequired,targetLocator:bt.isRequired,templates:l().arrayOf(O).isRequired},Et.propTypes={dispatch:l().func.isRequired,targetLocator:bt.isRequired,defaultTemplate:l().string},Et.defaultProps={defaultTemplate:""},jt.propTypes={initialState:l().shape({ownTemplates:l().arrayOf(O),inheritedTemplates:l().arrayOf(O)}).isRequired,defaultTemplates:l().objectOf(w).isRequired,targetLocator:bt.isRequired},window.setupReceiptTemplateList=function(e,t,a,r,c){document.addEventListener("DOMContentLoaded",(()=>{i.render(n.createElement(jt,{initialState:{ownTemplates:t,inheritedTemplates:a},defaultTemplates:r,targetLocator:c}),e)}))}}},e=>{e.O(0,[4644,4394,8502,2076],(()=>{return t=10048,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_receipts.admin.4d3ec115.bundle.js.map