<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Heroku deployments" href="heroku_server.html" /><link rel="prev" title="Setting up an experiment server with AWS" href="aws_server_setup.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>SSH servers - PsyNet 11.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=a26321a0" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">PsyNet 11.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">PsyNet 11.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/applications.html">When to use PsyNet?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/team.html">Team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/command_line.html">Command line</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../learning/how_to_learn.html">How to learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../learning/exercises/index.html">Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Exercises</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../learning/exercises/timeline.html">Timeline exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning/exercises/graphics.html">Graphics exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning/exercises/js_synth.html">JSSynth exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../learning/tracks/index.html">Tracks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Tracks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../learning/tracks/music_perception.html">Music perception track</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dependencies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dependencies/dallinger.html">Dallinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies/docker.html">Docker</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../installation/index.html">Installation overview</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Installation overview</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../installation/virtualenv_installation/index.html">Installing PsyNet via virtualenv</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Installing PsyNet via virtualenv</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/virtualenv_installation/linux.html">Installing PsyNet via virtualenv (Linux)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/virtualenv_installation/macos.html">Installing PsyNet via virtualenv (macOS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/virtualenv_installation/windows.html">Installing PsyNet via virtualenv (Windows)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../installation/docker_installation/index.html">Installing PsyNet via Docker</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Installing PsyNet via Docker</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/docker_installation/unix_installation.html">Installing PsyNet via Docker (macOS/Linux)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/docker_installation/windows_installation.html">Installing PsyNet via Docker (Windows)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXPERIMENT DEVELOPMENT</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/experiment_directory.html">Experiment directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/development_workflow.html">Development workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../demos/index.html">Demos</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Demos</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../demos/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/hello_world.html">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/timeline.html">Timeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/survey_js.html">SurveyJS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/trial.html">Trials (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/trial_2.html">Trials (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/trial_3.html">Trials (3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/audio.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/static_audio.html">Audio trial maker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/gibbs.html">Gibbs Sampling with People</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/audio_gibbs.html">Audio Gibbs Sampling with People</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/imitation_chains.html">Imitation chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/tapping_imitation_chain.html">Tapping imitation chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/mcmcp.html">Markov Chain Monte Carlo with People (MCMCP)</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../example_experiments/index.html">Example experiments</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Example experiments</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../example_experiments/carillon.html">Consonance and the carillon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../example_experiments/emotions-scales.html">Emotions of musical scales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../example_experiments/pitch-matching.html">Pitch-matching test</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/creating_a_new_experiment.html">Creating a new experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/classes.html">Classes in PsyNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/timeline.html">Timeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/assets.html">Assets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/specifying_dependencies.html">Specifying dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/tests.html">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/internationalization.html">Internationalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/synchronization.html">Synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/ad_page.html">The Ad Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/modular_page.html">Modular Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/graphics.html">Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/demography.html">Demography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/prescreening_tasks.html">Pre-screening tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/create_and_rate.html">Create and Rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/pre_deploy_routines.html">Pre-deploy routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/experiment_variables.html">Experiment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/unity_integration.html">Unity integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/writing_custom_frontends.html">Writing custom frontends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/event_management.html">Event management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/communicating_with_backend.html">Communicating with the back-end via custom routes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/payment_limits.html">Payment limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/deploy_tokens.html">Deploy tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/introduction_to_sql_alchemy.html">Introduction to SQLAlchemy</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/version_control_with_git.html">Version control with Git</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Version control with Git</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/version_control_with_git/essential_concepts.html">Essential concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/version_control_with_git/experiment_implementation_workflow.html">Experiment implementation workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/upgrading_to_psynet_10.html">Upgrading to PsyNet 10</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of API Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/asset.html">Asset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/audio_mixer.html">AudioMixer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bot.html">Bot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/command_line.html">Command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/consents.html">Consents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/demography.html">Demography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/error.html">Error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/experiment.html">Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/field.html">Field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/graphics.html">Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/js_synth.html">JSSynth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/media.html">Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/modular_page.html">ModularPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/participant.html">Participant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/prescreen.html">Prescreen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/process.html">Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/recruiters.html">Recruiters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/redis.html">Redis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/serialize.html">Serialize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sync.html">Sync</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/timeline.html">Timeline</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trial/index.html">Trial</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Trial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/audio.html">Audio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/audio_gibbs.html">AudioGibbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/chain.html">Chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/dense.html">Dense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/gibbs.html">Gibbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/graph.html">Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/imitation_chain.html">ImitationChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/main.html">Main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/media_gibbs.html">MediaGibbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/mcmcp.html">MCMCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/record.html">Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/static.html">Static</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/video.html">Video</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/utils.html">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/version.html">Version</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DEPLOYING</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="web_servers.html">Web servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_server_setup.html">Setting up an experiment server with AWS</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">SSH servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="heroku_server.html">Heroku deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="prolific.html">Deploying an experiment to Prolific</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_from_archive.html">Deploying from archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="export.html">Exporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to PsyNet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/workflow.html">Developer workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/contributing_a_feature_or_bugfix.html">Contributing a feature/bugfix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/prescreening_tasks.html">Creating pre-screening tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/updating_documentation.html">Updating documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/internationalization.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/running_tests.html">Running tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/making_a_release.html">Making a release</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dashboards</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dashboards/translation.html">Translation dashboard</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://gitlab.com/PsyNetDev/PsyNet/-/edit/master/docs/deploy/ssh_server.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="ssh-servers">
<h1>SSH servers<a class="headerlink" href="#ssh-servers" title="Link to this heading">#</a></h1>
<p>The recommended approach for hosting your own PsyNet experiments is to
set up your own remote server accessed via SSH. We will refer to such
servers as ‘SSH servers’.</p>
<section id="setting-up-the-remote-server">
<h2>Setting up the remote server<a class="headerlink" href="#setting-up-the-remote-server" title="Link to this heading">#</a></h2>
<p>There are several ways to set up your own remote server.
One way is to rent one via Amazon Web Services (see <a class="reference internal" href="aws_server_setup.html#aws-server-setup"><span class="std std-ref">tutorial</span></a>).
Other comparable recommended companies include Hetzner and Contabo.
As a very approximate rule of thumb, we recommend 5 GB of RAM for each
simultaneous experiment you think you will need to host.</p>
<p>Once you’ve set up your remote server, you need to make sure that your local computer
has passwordless SSH access to the remote server.
If you have a key pair for the server, you probably need to add it to your SSH agent
with code like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>path/to/your/key.pem
ssh-add<span class="w"> </span>path/to/your/key.pem
</pre></div>
</div>
<p>If you normally need a password to access the instance, you’ll need to
upload your local machine’s SSH key to the remote instance. If you don’t have
an SSH key already, generate one on your local machine:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh-keygen
</pre></div>
</div>
<p>Then upload it to the remote instance by running a command in the following form,
replacing the credentials and server address as appropriate:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh-copy-id<span class="w"> </span>yourusername@your-server.ac.uk
</pre></div>
</div>
<p>Verify that you can login passwordless by running the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>your-username@your-server.ac.uk
</pre></div>
</div>
<p>If this works, you’re ready to register the remote server within PsyNet/Dallinger.
Run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dallinger<span class="w"> </span>docker-ssh<span class="w"> </span>servers<span class="w"> </span>add<span class="w"> </span>--user<span class="w"> </span>your-username<span class="w"> </span>--host<span class="w"> </span>your-server.ac.uk
</pre></div>
</div>
</section>
<section id="setting-up-your-docker-registry">
<h2>Setting up your Docker registry<a class="headerlink" href="#setting-up-your-docker-registry" title="Link to this heading">#</a></h2>
<p>The Docker registry will host your Docker images. There are multiple platforms you can use to host your Docker images. Here we will cover docker.io and GitLab.
We will cover three ways to setup a Docker registry:
- personal Docker registry on docker.io
- group Docker registry on GitLab
- self-hosted Docker registry on GitLab</p>
<section id="personal-docker-registry-on-docker-io">
<h3>Personal Docker registry on docker.io<a class="headerlink" href="#personal-docker-registry-on-docker-io" title="Link to this heading">#</a></h3>
<ul>
<li><p>Go to <cite>docker.io &lt;https://www.docker.com/&gt;</cite> and setup an account</p></li>
<li><p>Download the Docker Desktop app and sign in</p></li>
<li><p>Add the following line to your <code class="docutils literal notranslate"><span class="pre">config.txt</span></code> if you only want to use it for this experiment or in <code class="docutils literal notranslate"><span class="pre">~/.dallingerconfig</span></code> if you want to use it as your default registry:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">docker_image_base_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>docker.io/&lt;docker_io_username&gt;/&lt;name_of_your_image&gt;
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="group-docker-registry-on-gitlab">
<h3>Group Docker registry on GitLab<a class="headerlink" href="#group-docker-registry-on-gitlab" title="Link to this heading">#</a></h3>
<p>Group Docker registries are a nice way to have all of your lab’s Docker images under the same umbrella.</p>
<p>There’s two ways to set up a Docker registry:
- A hosted Docker registry
- A self-hosted Docker registry</p>
<p>We’ll first go through the steps to setup a hosted Docker registry on Gitlab. First login to the GitLab docker registry:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>login<span class="w"> </span>registry.gitlab.com
</pre></div>
</div>
<p>The next step is to setup a public repository, e.g. a repository called “experiment-images” by the user “computational-audition”. This means the particular user (“computational-audition”) can now push to this registry. In the case of the lab, we suggest setting up a lab group where all users have “Maintainer” permissions. You can now add this group to your repository <a class="reference external" href="https://gitlab.com">https://gitlab.com</a>/&lt;user&gt;/&lt;repo&gt;/-/project_members (e.g., <a class="reference external" href="https://gitlab.com/computational-audition/experiment-images/-/project_members">https://gitlab.com/computational-audition/experiment-images/-/project_members</a>). Now each user in the lab group can push to the repository.</p>
<p>The last step is to add the registry to <code class="docutils literal notranslate"><span class="pre">.dallingerconfig</span></code>. To do this, you need to edit your local
<code class="docutils literal notranslate"><span class="pre">~/.dallingerconfig</span></code> file.</p>
<p>If you don’t have such a file already, you can create it like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>touch<span class="w"> </span>~/.dallingerconfig
</pre></div>
</div>
<p>You can then edit it on Mac like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>open<span class="w"> </span>~/.dallingerconfig
</pre></div>
</div>
<p>or simply with a text editor via your GUI.</p>
<p>Place a line like the following in your <code class="docutils literal notranslate"><span class="pre">~/.dallingerconfig</span></code>,
putting the link to your own image registry:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">docker_image_base_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>registry.gitlab.developers.cam.ac.uk/mus/cms/psynet-experiment-images
</pre></div>
</div>
<p>You can also host the registry yourself, e.g. under <code class="docutils literal notranslate"><span class="pre">registry.gitlab.developers.cam.ac.uk</span></code>. The steps are similar to above, but you will need to change the URL if you are using a self-hosted registry. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>login<span class="w"> </span>registry.gitlab.developers.cam.ac.uk
</pre></div>
</div>
<p>In some situations (e.g. federated authentication) you will not be able to login
to your account via the command-line in this way. Instead, you will have to create
a <a class="reference external" href="https://gitlab.developers.cam.ac.uk/-/profile/personal_access_tokens">personal access token via GitLab</a>
and then login with a command like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>login<span class="w"> </span>registry.gitlab.developers.cam.ac.uk<span class="w"> </span>-u<span class="w"> </span>your-username
</pre></div>
</div>
<p>You should then enter your access token when prompted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you see this error:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>WARNING!<span class="w"> </span>Your<span class="w"> </span>password<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>stored<span class="w"> </span>unencrypted<span class="w"> </span><span class="k">in</span><span class="w"> </span>/home/pmch2/.docker/config.json.

Configure<span class="w"> </span>a<span class="w"> </span>credential<span class="w"> </span>helper<span class="w"> </span>to<span class="w"> </span>remove<span class="w"> </span>this<span class="w"> </span>warning.<span class="w"> </span>See

https://docs.docker.com/engine/reference/commandline/login/#credentials-store
</pre></div>
</div>
<p>you can probably continue without worrying about it. We are still working out
the best way to deal with Docker credential management in PsyNet/Dallinger.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You might not be able to login if you originally created your gitlab account via an external service (e.g. GitHub, Gmail).
In that case, make sure, that you can login to GitLab in the browser, using only your email adress.
You might need to disconnect your external (e.g. GitHub) account from your GitLab account
(User Settings -&gt; Account) and reset your password to do so.</p>
</div>
<p>You then need to do exactly the same <cite>docker login</cite> process but on your remote server.
To do this, you need to open an SSH terminal to your server, if you haven’t already:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>your-username@your-server.ac.uk
</pre></div>
</div>
<p>Then run the same <cite>docker login</cite> command that you ran previously.</p>
<p>Finally, you need to place a line like the following in your <code class="docutils literal notranslate"><span class="pre">~/.dallingerconfig</span></code>,
putting the link to your own image registry:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">docker_image_base_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>registry.gitlab.developers.cam.ac.uk/mus/cms/psynet-experiment-images
</pre></div>
</div>
<p>That’s it! You should be all set up now.</p>
</section>
</section>
<section id="deploying-experiments-via-ssh">
<h2>Deploying experiments via SSH<a class="headerlink" href="#deploying-experiments-via-ssh" title="Link to this heading">#</a></h2>
<p>You deploy experiments using the <code class="docutils literal notranslate"><span class="pre">psynet</span> <span class="pre">deploy</span> <span class="pre">command</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psynet<span class="w"> </span>deploy<span class="w"> </span>ssh<span class="w"> </span>--app<span class="w"> </span>your-app-name
</pre></div>
</div>
<p>By default, this will deploy your app to a hostname that looks like this:</p>
<p><a class="reference external" href="https://your-app-name.121.101.152.23.nip.io">https://your-app-name.121.101.152.23.nip.io</a></p>
<p>where <code class="docutils literal notranslate"><span class="pre">121.101.152.23</span></code> is the IP address of your web server.
If your server is set up with a DNS record, it is possible to use this instead as the URL.
For example, running this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psynet<span class="w"> </span>deploy<span class="w"> </span>ssh<span class="w"> </span>--app<span class="w"> </span>your-app-name<span class="w"> </span>--dns-host<span class="w"> </span>my-web-server.com
</pre></div>
</div>
<p>would make your app available at this link:</p>
<p><a class="reference external" href="https://your-app-name.my-web-server.com">https://your-app-name.my-web-server.com</a></p>
<p>Note that your DNS record must already be set up to resolve the subdomain you want to use (e.g. <code class="docutils literal notranslate"><span class="pre">your-app-name</span></code>)
to the IP address of the server.
This is a one-time job that should be performed when preparing the web server to deploy experiments.
You can either do this by setting up a subdomain wildcard (e.g. <code class="docutils literal notranslate"><span class="pre">*.my-web-server.com</span></code>, or by deciding in advance
what experiment names to support, and then setting up the DNS to support those names
(e.g. <code class="docutils literal notranslate"><span class="pre">psynet-01.my-web-server.com</span></code>, <code class="docutils literal notranslate"><span class="pre">psynet-02.my-web-server.com</span></code>, etc.).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your DNS record only supports particular subdomains then you have to choose your app name to match
one of those subdomains. For example, when deploying through the web server of the Centre for Music and Science
at Cambridge, only app names of the form <code class="docutils literal notranslate"><span class="pre">psynet-01</span></code>, <code class="docutils literal notranslate"><span class="pre">psynet-02</span></code>, …, <code class="docutils literal notranslate"><span class="pre">psynet-20</span></code> are supported.</p>
</div>
<p>Under the hood, the deployment command works as follows:</p>
<ul class="simple">
<li><p>Run any preliminary steps, e.g. uploading assets to the remote server</p></li>
<li><p>Build the Docker image, packaging up all local code and dependencies</p></li>
<li><p>Push the Docker image to the remote server</p></li>
<li><p>Instruct the remote server to pull the Docker image</p></li>
<li><p>Instruct the remote server to spin up the Docker app</p></li>
<li><p>Instruct the remote server to launch the experiment</p></li>
</ul>
<p>This command can go wrong at several points. The parts that happen on the local
machine are usually easiest to debug. When things go wrong on the remote server,
you may need to connect to it via a separate SSH terminal to work out what’s going on.
To connect to the server, run this in a separate terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>your-username@your-server.ac.uk
</pre></div>
</div>
<p>Navigate to the experiment’s folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/dallinger/your-app-name
</pre></div>
</div>
<p>If this folder doesn’t exist yet, your command probably failed before it got
to the remote server.</p>
<p>Now view the Docker logs:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>compose<span class="w"> </span>logs
</pre></div>
</div>
<p>Often you will see the real error message there. You may need to scroll up through
the logs to see the full picture; sometimes there are multiple error messages,
but only the first one is the ‘real’ problem.</p>
<p>Sometimes it is useful to execute code on this remote Docker instance to work out
what happened. You can do this as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>web<span class="w"> </span>/bin/bash
</pre></div>
</div>
</section>
<section id="under-the-hood">
<h2>Under the hood<a class="headerlink" href="#under-the-hood" title="Link to this heading">#</a></h2>
<p>It’s worth knowing a few things about what’s happening under the hood here so that you
are better positioned to debug things when they go wrong.</p>
<p>The SSH server works using Docker. Docker is a containerization service that virtualizes
entire operating systems and installed dependencies. This isolation is very helpful for ensuring
application portability.</p>
<p>When we work with Docker, we begin by creating a Docker <em>image</em>. A docker image is a snapshot
of an operating system in a particular status. The operating system we use here is Linux.
If you are familiar with the terminal in MacOS, then you will find Linux fairly intuitive.</p>
<p>Docker images are defined by writing Dockerfiles. Your experiment directory contains such a file,
it will be named <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code>. Have a read through one such file to get a picture of how
the Docker image ends up being defined.</p>
<p>When we run an app we create one or more containers based on Dockerfiles. Containers are virtual
computers that are initialized according the snapshot provided in the Docker image.
You can run many containers on the same computer, but of course they all consume their own
computational resources.</p>
<p>The SSH server uses a tool called <em>docker compose</em> to orchestrate multiple containers for the
same app. Each PsyNet experiment contains four distinct containers:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">web</span></code> - serves HTTP requests</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">worker</span></code> - process asynchronous tasks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clock</span></code> - schedules tasks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">redis</span></code> - stores variable values</p></li>
</ul>
<p>The SSH server additionally provides two further containers which are shared across all experiments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">postgresql</span></code> - hosts the experiment databases</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">caddy</span></code> - redirects HTTP requests to the appropriate experiment app. See
<a class="reference external" href="https://caddyserver.com/">Caddy server</a> for more details.</p></li>
</ul>
<p>When you deploy an experiment to the SSH server, a folder is created in the location
<code class="docutils literal notranslate"><span class="pre">~/dallinger/your-app-name</span></code> which contains a Docker compose configuration called
<code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code>. You can inspect this configuration file to learn about how the app
is defined. When you SSH to this server, you can interact with this folder to
gain entry to your application. For example, you can run the following code to gain SSH access
to the web process of your app:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/dallinger/your-app-name
docker<span class="w"> </span>compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>web<span class="w"> </span>/bin/bash
</pre></div>
</div>
<p>Within the same directory, you can run the following command to see live logs from your app:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>compose<span class="w"> </span>logs
</pre></div>
</div>
<p>You can run the following command to view the status of all Docker containers currently running on the server,
including containers from other apps:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>ps
</pre></div>
</div>
<p>Once you are done with your experiment, you can export the data to your local computer using the following command,
but run it on your local computer, not via your SSH terminal.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psynet<span class="w"> </span><span class="nb">export</span><span class="w"> </span>ssh<span class="w"> </span>--app<span class="w"> </span>your-app-name
</pre></div>
</div>
<p>For more information, see <a class="reference external" href="export.html">Exporting</a>.</p>
<p>You can then tear down your app via the following command, again run on your local computer:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psynet<span class="w"> </span>destroy<span class="w"> </span>ssh<span class="w"> </span>--app<span class="w"> </span>your-app-name
</pre></div>
</div>
</section>
<section id="connecting-to-the-database-via-ssh">
<h2>Connecting to the database via SSH<a class="headerlink" href="#connecting-to-the-database-via-ssh" title="Link to this heading">#</a></h2>
<p>It is possible to connect to the remote server’s PostgreSQL database via SSH.
This requires a one-time setup where you connect your local database client to the remote server.
We know that this is straightforward using Postico, a free database client for MacOS that we
recommend for use with PsyNet.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can only connect to the database once you have deployed at least one experiment to the server,
thereby initializing the PostgreSQL instance.</p>
</div>
<p>Before you can connect to the database, you need to find what internal IP address the database is running on.
To do this, SSH to the server and run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>inspect<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-f<span class="w"> </span><span class="s1">&#39;{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#39;</span><span class="w"> </span>dallinger-postgresql-1
</pre></div>
</div>
<p>Copy and paste the IP address that is returned.</p>
<p>Now, within Postico (or your alternative client), you should select the option to create a new connection,
and then fill in the following details:</p>
<ul class="simple">
<li><p>Host: the IP address you just copied</p></li>
<li><p>Port: 5432</p></li>
<li><p>User: dallinger</p></li>
<li><p>Password: dallinger</p></li>
<li><p>Tick ‘Connect via SSH tunnel’</p></li>
<li><p>SSH Host: the (external) IP address of your server, or its domain name</p></li>
<li><p>SSH User: your username on the server</p></li>
<li><p>Private key: the path to your private key (e.g. <code class="docutils literal notranslate"><span class="pre">~/.ssh/id_rsa</span></code>)</p></li>
</ul>
<p>You should now be able to connect to the PostgreSQL instance on the remote server.
This should contain multiple databases, one for each experiment you have deployed.</p>
</section>
<section id="known-issues">
<h2>Known issues<a class="headerlink" href="#known-issues" title="Link to this heading">#</a></h2>
<p>When many apps are deployed on the same server it is possible that certain apps
eat up too many database connections. This can manifest as an error like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psycopg2.OperationalError:<span class="w"> </span>FATAL:<span class="w">  </span>remaining<span class="w"> </span>connection<span class="w"> </span>slots<span class="w"> </span>are<span class="w"> </span>reserved<span class="w"> </span><span class="k">for</span><span class="w"> </span>non-replication<span class="w"> </span>superuser<span class="w"> </span>connections
</pre></div>
</div>
<p>To check the current connections to the database,
run this on the remote server:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/dallinger
docker<span class="w"> </span>compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>postgresql<span class="w"> </span>/bin/bash
psql<span class="w"> </span>-U<span class="w"> </span>dallinger

<span class="k">select</span><span class="w"> </span>pid<span class="w"> </span>as<span class="w"> </span>process_id,
<span class="w">   </span>usename<span class="w"> </span>as<span class="w"> </span>username,
<span class="w">   </span>datname<span class="w"> </span>as<span class="w"> </span>database_name,
<span class="w">   </span>client_addr<span class="w"> </span>as<span class="w"> </span>client_address,
<span class="w">   </span>application_name,
<span class="w">   </span>backend_start,
<span class="w">   </span>state,
<span class="w">   </span>state_change
from<span class="w"> </span>pg_stat_activity<span class="p">;</span>
</pre></div>
</div>
<p>This will print a table of database connections. The number of rows is the number of database
connections. The limit is by default 100; if you are close to 100, then you are close to trouble.</p>
<p>Normally you can (temporarily) resolve problems with the number of connections by restarting certain
processes in an experiment. Restarting is fast and should not significantly impact on user experiences.
To restart processes for a given app, run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/dallinger/your-app-name
docker<span class="w"> </span>compose<span class="w"> </span>restart<span class="w"> </span>web
docker<span class="w"> </span>compose<span class="w"> </span>restart<span class="w"> </span>worker
docker<span class="w"> </span>compose<span class="w"> </span>restart<span class="w"> </span>clock
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Sometimes we see SQLAlchemy errors as a result of running related commands, we’re not entirely
sure when/why this happens. For now it’s worth avoiding restarting processes unless absolutely
necessary. It’s good to test that your app still works after doing this.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="heroku_server.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Heroku deployments</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="aws_server_setup.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Setting up an experiment server with AWS</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Peter Harrison
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">SSH servers</a><ul>
<li><a class="reference internal" href="#setting-up-the-remote-server">Setting up the remote server</a></li>
<li><a class="reference internal" href="#setting-up-your-docker-registry">Setting up your Docker registry</a><ul>
<li><a class="reference internal" href="#personal-docker-registry-on-docker-io">Personal Docker registry on docker.io</a></li>
<li><a class="reference internal" href="#group-docker-registry-on-gitlab">Group Docker registry on GitLab</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deploying-experiments-via-ssh">Deploying experiments via SSH</a></li>
<li><a class="reference internal" href="#under-the-hood">Under the hood</a></li>
<li><a class="reference internal" href="#connecting-to-the-database-via-ssh">Connecting to the database via SSH</a></li>
<li><a class="reference internal" href="#known-issues">Known issues</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=bffcfdfb"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/js/custom.js?v=ca86d9ac"></script>
    </body>
</html>