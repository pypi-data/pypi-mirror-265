<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Writing custom frontends" href="writing_custom_frontends.html" /><link rel="prev" title="Experiment variables" href="experiment_variables.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Unity integration - PsyNet 11.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=a26321a0" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">PsyNet 11.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">PsyNet 11.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/applications.html">When to use PsyNet?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/team.html">Team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/command_line.html">Command line</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../learning/how_to_learn.html">How to learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../learning/exercises/index.html">Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Exercises</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../learning/exercises/timeline.html">Timeline exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning/exercises/graphics.html">Graphics exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning/exercises/js_synth.html">JSSynth exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../learning/tracks/index.html">Tracks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Tracks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../learning/tracks/music_perception.html">Music perception track</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dependencies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dependencies/dallinger.html">Dallinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies/docker.html">Docker</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../installation/index.html">Installation overview</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Installation overview</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../installation/virtualenv_installation/index.html">Installing PsyNet via virtualenv</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Installing PsyNet via virtualenv</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/virtualenv_installation/linux.html">Installing PsyNet via virtualenv (Linux)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/virtualenv_installation/macos.html">Installing PsyNet via virtualenv (macOS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/virtualenv_installation/windows.html">Installing PsyNet via virtualenv (Windows)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../installation/docker_installation/index.html">Installing PsyNet via Docker</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Installing PsyNet via Docker</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/docker_installation/unix_installation.html">Installing PsyNet via Docker (macOS/Linux)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/docker_installation/windows_installation.html">Installing PsyNet via Docker (Windows)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXPERIMENT DEVELOPMENT</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/experiment_directory.html">Experiment directory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/development_workflow.html">Development workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiment_development/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../demos/index.html">Demos</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Demos</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../demos/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/hello_world.html">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/timeline.html">Timeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/survey_js.html">SurveyJS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/trial.html">Trials (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/trial_2.html">Trials (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/trial_3.html">Trials (3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/audio.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/static_audio.html">Audio trial maker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/gibbs.html">Gibbs Sampling with People</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/audio_gibbs.html">Audio Gibbs Sampling with People</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/imitation_chains.html">Imitation chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/tapping_imitation_chain.html">Tapping imitation chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos/mcmcp.html">Markov Chain Monte Carlo with People (MCMCP)</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../example_experiments/index.html">Example experiments</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Example experiments</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../example_experiments/carillon.html">Consonance and the carillon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../example_experiments/emotions-scales.html">Emotions of musical scales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../example_experiments/pitch-matching.html">Pitch-matching test</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="creating_a_new_experiment.html">Creating a new experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="classes.html">Classes in PsyNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeline.html">Timeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="assets.html">Assets</a></li>
<li class="toctree-l2"><a class="reference internal" href="specifying_dependencies.html">Specifying dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="tests.html">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="internationalization.html">Internationalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="synchronization.html">Synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad_page.html">The Ad Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="modular_page.html">Modular Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="graphics.html">Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="demography.html">Demography</a></li>
<li class="toctree-l2"><a class="reference internal" href="prescreening_tasks.html">Pre-screening tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_and_rate.html">Create and Rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="pre_deploy_routines.html">Pre-deploy routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="experiment_variables.html">Experiment variables</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Unity integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing_custom_frontends.html">Writing custom frontends</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_management.html">Event management</a></li>
<li class="toctree-l2"><a class="reference internal" href="communicating_with_backend.html">Communicating with the back-end via custom routes</a></li>
<li class="toctree-l2"><a class="reference internal" href="payment_limits.html">Payment limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy_tokens.html">Deploy tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction_to_sql_alchemy.html">Introduction to SQLAlchemy</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="version_control_with_git.html">Version control with Git</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Version control with Git</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="version_control_with_git/essential_concepts.html">Essential concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="version_control_with_git/experiment_implementation_workflow.html">Experiment implementation workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="upgrading_to_psynet_10.html">Upgrading to PsyNet 10</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of API Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/asset.html">Asset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/audio_mixer.html">AudioMixer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bot.html">Bot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/command_line.html">Command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/consents.html">Consents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/demography.html">Demography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/error.html">Error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/experiment.html">Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/field.html">Field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/graphics.html">Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/js_synth.html">JSSynth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/media.html">Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/modular_page.html">ModularPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/participant.html">Participant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/prescreen.html">Prescreen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/process.html">Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/recruiters.html">Recruiters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/redis.html">Redis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/serialize.html">Serialize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sync.html">Sync</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/timeline.html">Timeline</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/trial/index.html">Trial</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Trial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/audio.html">Audio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/audio_gibbs.html">AudioGibbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/chain.html">Chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/dense.html">Dense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/gibbs.html">Gibbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/graph.html">Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/imitation_chain.html">ImitationChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/main.html">Main</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/media_gibbs.html">MediaGibbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/mcmcp.html">MCMCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/record.html">Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/static.html">Static</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trial/video.html">Video</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/utils.html">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/version.html">Version</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DEPLOYING</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deploy/web_servers.html">Web servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/aws_server_setup.html">Setting up an experiment server with AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/ssh_server.html">SSH servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/heroku_server.html">Heroku deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/prolific.html">Deploying an experiment to Prolific</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/deploy_from_archive.html">Deploying from archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/export.html">Exporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to PsyNet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/workflow.html">Developer workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/contributing_a_feature_or_bugfix.html">Contributing a feature/bugfix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/prescreening_tasks.html">Creating pre-screening tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/updating_documentation.html">Updating documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/internationalization.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/running_tests.html">Running tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/making_a_release.html">Making a release</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dashboards</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dashboards/translation.html">Translation dashboard</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://gitlab.com/PsyNetDev/PsyNet/-/edit/master/docs/tutorials/unity_integration.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <style> .red {color: red;} </style><section id="unity-integration">
<h1>Unity integration<a class="headerlink" href="#unity-integration" title="Link to this heading">#</a></h1>
<p><strong>See associated</strong> <a class="reference external" href="https://gitlab.com/computational-audition-lab/ofer/unitydemo">Git repository</a>.</p>
<p>PsyNet includes several GUI features that can accelerate the development of appealing experimental environments. In addition, standard HTML5 and WebGL features can be implemented with relative ease. The built-in network visualization panel of the dashboard, is a nice example of how such tools can be used. However, for experiments where a sophisticated and gamified user interface in either 2D or 3D is desired, it makes more sense to use a well developed 3rd party GUI RDE. Unity 3D is among the leading RDEs for games, and it has several advantages:</p>
<ol class="arabic simple">
<li><p>The same code base can be compiled and deployed with relative ease, as a native app,  across platforms including WebGL, Windows, macOS, iOS, Android, etc.</p></li>
<li><p>Both 2D and 3D virtual worlds physics are well developed</p></li>
<li><p>There are many 3rd party components in the Unity App store that can be easily integrated. These include both high and low level tools such as embedded graphs, a virtual playable 3D piano, animated coins, etc.</p></li>
</ol>
<p>Learning Unity is outside the scope of this tutorial, but there are many great resources for learning Unity including Unity Learning [<a class="reference external" href="https://learn.unity.com/">https://learn.unity.com/</a>]. We will start with a quick tutorial of a simple Unity game, which is provided in the <a class="reference external" href="https://gitlab.com/computational-audition-lab/ofer/unitydemo">demo project</a>.</p>
<p>The figure below shows the simple Unity 3D world that we created. It includes a player (yellow cylinder) and several collectable objects (red and blue cubes):</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/unity_3d_player.png"><img alt="../_images/unity_3d_player.png" src="../_images/unity_3d_player.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">A Unity 3D scene with a player (yellow cylinder) and collectable objects</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In the game, the player collect objects to gain score:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_score.png"><img alt="../_images/unity_3d_score.png" src="../_images/unity_3d_score.png" style="width: 600px;" /></a>
</figure>
<p><br />
Once the goal of collecting 10 objects is achieved, the game ends:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_game_over.png"><img alt="../_images/unity_3d_game_over.png" src="../_images/unity_3d_game_over.png" style="width: 600px;" /></a>
</figure>
<p><br />
In this demo, PsyNet assigns participants into three groups. In group 1 players gain two points for each item they collect, in group 2 players gain three points per item, and in group 3 players gain four points per item. In addition, Psynet sets the number of points needed to end the game.</p>
<p>These variables are defined in the beginning of the Psynet experiment file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]</span> <span class="c1"># The score (gain) for collecting an item</span>
<span class="n">Goal</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Once score reach this goal the game is finished</span>
</pre></div>
</div>
<p>So now Psynet will automatically recruit participants, assign them to groups and once a participant begins playing, PsyNet and Unity need to start talking to each other: PsyNet needs to send game parameters to Unity, and Unity needs to report each coin collection event to Psynet. Note that whereas Psynet uses Python, Unity scripts are C# code. Note also that the Unity app is compiled as a WebGL app, which allows us to run the game online embedded in a web browser page, which Psynet creates. This means that once we compiled the game, Unity code cannot be accessed or modified. However, our API has a debug mode, which allows you to simultaneously debug PsyNet and Unity code inside the Unity IDE prior to compilation.</p>
<p>Embedding Unity in Psynet involves several challenges, which we alleviated by developing a PsyNet-Unity API. The role of the API is to allow a nearly real-time, two way communication between Unity and PsyNet: The communication form Unity to PsyNet is designed to be instantaneous, and can be functionally almost continuous. On the other hand, communication from PsyNet to Unity is typically intermittent. In the mechanisms we describe below, Psynet is “driving” Unity by setting variables and parameters via the content of the Unity page, within which Unity is embedded. Here is an overall illustration of how it works:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_workflow.png"><img alt="../_images/unity_3d_workflow.png" src="../_images/unity_3d_workflow.png" style="width: 800px;" /></a>
</figure>
<p><br />
In the example above, the participant is playing a coin collecting Unity game embedded in a web browser.  PsyNet recruits participants and assigns each participant with game parameters, which are embedded in the webpage window. When the game initiates, Unity reads these parameters and the game can then start.  As the game proceeds, Unity sends information to Psynet (e.g., that the participants collected a coin). If the game has several stages, Unity can drive these transitions by creating a new (invisible) page with different parameters. Finally, Unity decides when to end the game, and moves forward with the timeline.</p>
<p>Note that in the PsyNet timeline the Unity app is simply the trial maker, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Exp</span><span class="p">(</span><span class="n">psynet</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">Experiment</span><span class="p">):</span>
   <span class="n">consent_audiovisual_recordings</span> <span class="o">=</span> <span class="kc">False</span>
   <span class="n">timeline</span> <span class="o">=</span> <span class="n">Timeline</span><span class="p">(</span>
       <span class="n">MainConsent</span><span class="p">(),</span>
       <span class="n">trial_maker</span><span class="p">,</span> <span class="c1"># The Unity game</span>
       <span class="n">InfoPage</span><span class="p">(</span><span class="s2">&quot;You finished the experiment!&quot;</span><span class="p">,</span> <span class="n">time_estimate</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
       <span class="n">SuccessfulEndPage</span><span class="p">(),</span>
   <span class="p">)</span>
</pre></div>
</div>
<p>In the demo experiment will see a Page type called UnityGamePage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">page</span> <span class="o">=</span> <span class="n">UnityGamePage</span><span class="p">(</span>
   <span class="c1"># Send this string to Unity</span>
   <span class="n">contents</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
   <span class="c1"># We stay in the same session.</span>
   <span class="n">session_id</span><span class="o">=</span><span class="n">SAME_SESSION_ID</span><span class="p">,</span>
   <span class="n">time_estimate</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="k">return</span> <span class="n">page</span>  <span class="c1"># list_of_pages</span>
</pre></div>
</div>
<p>This page contains data that PsyNet will sent to Unity in real time (adaptively for each player) including the two game parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">&quot;goal&quot;</span><span class="p">:</span> <span class="n">goal</span><span class="p">,</span>
   <span class="s2">&quot;gain&quot;</span><span class="p">:</span> <span class="n">the_rule</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The rest is taken care of by the API.</p>
<section id="running-the-game">
<h2>Running the game<a class="headerlink" href="#running-the-game" title="Link to this heading">#</a></h2>
<p>Running the game is easy, just go to the terminal, browse to the demo folder, activate your virtual environment, and type <code class="docutils literal notranslate"><span class="pre">psynet</span> <span class="pre">debug</span></code>. The project should then run in your browser window, just like any other PsyNet project, after informed consent, Unity should run embedded in your page,  and once the game is over PsyNet timeline will continue.</p>
</section>
<section id="developing-and-debugging-the-unity-game">
<h2>Developing and debugging the Unity game<a class="headerlink" href="#developing-and-debugging-the-unity-game" title="Link to this heading">#</a></h2>
<p>We will first describe the ‘Installation’ process. Then we will explain how the Unity-Psynet API works. Finally, we will go line by line through the demo, which will allow you to independently build a project from scratch. example.</p>
<section id="installing-a-unity-psynet-project">
<h3>Installing a Unity-Psynet project<a class="headerlink" href="#installing-a-unity-psynet-project" title="Link to this heading">#</a></h3>
<p>You should install the free (Personal) version of Unity. Currently, we use Unity 2020.3</p>
<p><a class="reference external" href="https://store.unity.com/front-page#plans-individual">https://store.unity.com/front-page#plans-individual</a></p>
<p>Once Unity is installed in your system, it might be useful to begin by opening the very simple testing project that we included in the demo. It should look more or less like this:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_project.png"><img alt="../_images/unity_3d_project.png" src="../_images/unity_3d_project.png" style="width: 800px;" /></a>
</figure>
<p><br />
In the center, you see the scene including a plane, several 3D objects (cubes) and a yellow cylinder representing the player. Note, however, the we designed this project for PsyNet, and it will not run independently. If you see these errors:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_errors.png"><img alt="../_images/unity_3d_errors.png" src="../_images/unity_3d_errors.png" style="width: 800px;" /></a>
</figure>
<p><br />
This is because you tried running it before setting up the PsyNet experiment.</p>
<p>The API allows you to debug the Unity project inside the Unity IDE. That is, before you even created the WebGL app. For this, all you need to do is to set the debug variable in the Psynet experiment file to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stimuli ---------------------------------------------------------------------</span>
<span class="n">Debug</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Now, open your terminal, navigate to the demo folder, and run <code class="docutils literal notranslate"><span class="pre">psynet</span> <span class="pre">debug</span> <span class="pre">--verbose</span></code>. If everything is working as intended, you should see and informed consent form, and then you will see this page:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_debug_page.png"><img alt="../_images/unity_3d_debug_page.png" src="../_images/unity_3d_debug_page.png" style="width: 800px;" /></a>
</figure>
<p><br />
Note that the page content includes the two game parameters: the goal (score needed to finish the game) and the gain (number of points per item collection).</p>
<p>Only now you may go to Unity, run and debug your game. Unity has an excellent debugger. We strongly recommend installing the JetBrain Rider as the editor (do not use the default Visual Studio). Rider (<a class="reference external" href="https://www.jetbrains.com/rider/">https://www.jetbrains.com/rider/</a>) is very similar to PyCharm, and it is free for academic usage. Once Rider is installed, go to Unity, and in Preferences, select Rider:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_rider.png"><img alt="../_images/unity_3d_rider.png" src="../_images/unity_3d_rider.png" style="width: 800px;" /></a>
</figure>
<p><br />
Now you can access the Unity scripts like this: in the Hierarchy, click the ‘world’ item. Then in the Inspector, click the three vertical dots on the right of the GameManager script and select ‘Edit Script’.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_edit_script.png"><img alt="../_images/unity_3d_edit_script.png" src="../_images/unity_3d_edit_script.png" style="width: 800px;" /></a>
</figure>
<p><br />
This will open Rider and will show you the editor and debugger windows:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_rider_editor.png"><img alt="../_images/unity_3d_rider_editor.png" src="../_images/unity_3d_rider_editor.png" style="width: 800px;" /></a>
</figure>
<p><br />
Make sure you are attached to the Unity editor and that the debug button is on:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_debug_button.png"><img alt="../_images/unity_3d_debug_button.png" src="../_images/unity_3d_debug_button.png" style="width: 800px;" /></a>
</figure>
<p><br />
You can now create breakpoints, and run the game from the IDE until everything works.</p>
<p>Next you will want to compile your WebGL app.</p>
<p>Go back to Unity, and in the menu select file -&gt; Build Settings…</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_build_settings.png"><img alt="../_images/unity_3d_build_settings.png" src="../_images/unity_3d_build_settings.png" style="width: 800px;" /></a>
</figure>
<p><br />
Make sure that WebGL is selected. Before clicking Build And Run, click on Player Settings…</p>
<p>There, in publishing settings, disable the Compression Format (see bottom):</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_build_settings_disable_compression.png"><img alt="../_images/unity_3d_build_settings_disable_compression.png" src="../_images/unity_3d_build_settings_disable_compression.png" style="width: 800px;" /></a>
</figure>
<p><br />
<span class="red">Important: you must name your app WebGL.</span></p>
<p>Only then go back to build settings and click Build And Run. Compiling the WebGL may take several minutes. Unity will then open a browser window and will attempt to run your WebGL app – but you will get an error – ignore it. This is just telling you that your project cannot run without PsyNet.</p>
<p>Now navigate to your WebGL folder (inside your Unity project), and make sure the files in the Build folder are exactly like this:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_build_folder.png"><img alt="../_images/unity_3d_build_folder.png" src="../_images/unity_3d_build_folder.png" style="width: 340px;" /></a>
</figure>
<p><br />
Next, all you need to do is to copy the Build and TemplateData folders from WebGL  into your Unity project. They should go under Static/Scripts/</p>
<p>Finally, go to your PsyNet experiment code, set the debug variable to False, and run your project.</p>
</section>
<section id="understanding-the-psynet-unity-api">
<h3>Understanding the Psynet Unity API<a class="headerlink" href="#understanding-the-psynet-unity-api" title="Link to this heading">#</a></h3>
<p>In Unity, the PsyNet API is implemented in two files. At the lowest level there is a JaveScriptUnity file in the Unity project Plugins folder. This library allows information to be communicated between Unity and PsyNet in the form of JSON data structures. This file also connects between the client WebGL app and PsyNet to set the participant and page identity. You should never edit this file, but make sure it is in place:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_JaveScriptUnity.jslib.png"><img alt="../_images/unity_3d_JaveScriptUnity.jslib.png" src="../_images/unity_3d_JaveScriptUnity.jslib.png" style="width: 340px;" /></a>
</figure>
<p><br />
The API communication logic is implemented in a Unity script called  WebRequestManage.cs. It  should give you all utilities needed to take advantage of the Psynet API functionality, enabling back and forth communication between Unity and Psynet. We will discuss this unit usage below. In most cases, you will use it but not edit it.</p>
</section>
<section id="how-to-use-psynet-to-drive-a-unity-game">
<h3>How to use PsyNet to “drive” a Unity game<a class="headerlink" href="#how-to-use-psynet-to-drive-a-unity-game" title="Link to this heading">#</a></h3>
<p>Next, we explain how the Unity scripts interact with Psynet.</p>
<p>First, you need to link the WebRequestManager script to your game. This is done simply by creating an empty game object in unity, and adding the script to the object hierarchy:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/unity_3d_WebRequestManager.png"><img alt="../_images/unity_3d_WebRequestManager.png" src="../_images/unity_3d_WebRequestManager.png" style="width: 800px;" /></a>
</figure>
<p><br />
Next, we need to create a pipeline of event handlers, which we do in OnEnable:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">void</span><span class="w"> </span><span class="nf">OnEnable</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">WebRequestManager</span><span class="p">.</span><span class="n">onPsynetSyncResponse</span><span class="w"> </span><span class="o">+=</span><span class="w">  </span><span class="n">HandlePsynetSyncResult</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can easily create event handlers, although the ones we provide might suffice:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">HandlePsynetSyncResult</span><span class="p">(</span><span class="n">PsynetSyncResponse</span><span class="w"> </span><span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="n">opcode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">res</span><span class="p">.</span><span class="n">opCode</span><span class="p">;</span><span class="w"> </span><span class="c1">// code tells WebrequestManager what is the context of the call</span>
<span class="w">     </span><span class="kt">string</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">res</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>
<span class="w">     </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="k">case</span><span class="w"> </span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_SUBMITTTED</span><span class="p">:</span>
<span class="w">             </span><span class="n">AfterPageSubmitted</span><span class="p">();</span>
<span class="w">             </span><span class="k">break</span><span class="p">;</span>
<span class="w">         </span><span class="k">case</span><span class="w"> </span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_UPDATED</span><span class="p">:</span>
<span class="w">             </span><span class="n">AfterPageUpdate</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="w">             </span><span class="k">break</span><span class="p">;</span>
<span class="w">         </span><span class="k">case</span><span class="w"> </span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_INIT</span><span class="p">:</span>
<span class="w">             </span><span class="n">StartCoroutine</span><span class="p">(</span><span class="n">WebRequestManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_UPDATED</span><span class="p">));</span>
<span class="w">             </span><span class="k">break</span><span class="p">;</span>
<span class="w">         </span><span class="k">case</span><span class="w"> </span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_ERROR</span><span class="p">:</span>
<span class="w">             </span><span class="c1">// Finish the game</span>
<span class="w">             </span><span class="n">terminateGame</span><span class="p">.</span><span class="n">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="w">             </span><span class="k">break</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>
<span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Note that each of these events trigger a custom GameManager function such as <code class="docutils literal notranslate"><span class="pre">AfterPageSubmitted()</span></code>. This is where you will implement much of your game logic. In other cases, the event will trigger another WebRequestManager coroutine, which will, in turn, fire another event, e.g., :</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">case</span><span class="w"> </span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_INIT</span><span class="p">:</span>
<span class="w">    </span><span class="n">StartCoroutine</span><span class="p">(</span><span class="n">WebRequestManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_UPDATED</span><span class="p">));</span>
</pre></div>
</div>
<p>Here, we call <code class="docutils literal notranslate"><span class="pre">GetPage()</span></code> after game initiation, because we want to get instructions from Psynet on how to run the game. We are going to call <code class="docutils literal notranslate"><span class="pre">GetPage()</span></code> during the game as well, as we will show below.</p>
</section>
<section id="game-initiation-logic">
<h3>Game Initiation logic<a class="headerlink" href="#game-initiation-logic" title="Link to this heading">#</a></h3>
<p>When the game starts, Unity will need to know the PyNet user id and the procedure for communication via JSON, this is done in the <code class="docutils literal notranslate"><span class="pre">Start()</span></code> function of the game, by calling the WebRequestManager <code class="docutils literal notranslate"><span class="pre">Init()</span></code> function. Note that we use a coroutine and events because these functions are not synchronous and we cannot predict it would take them to return. This means that we may not want to allow the game to really start before this function returns:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Start is called before the first frame update</span>
<span class="k">void</span><span class="w"> </span><span class="nf">Start</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">StartCoroutine</span><span class="p">(</span><span class="n">WebRequestManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">Init</span><span class="p">(</span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_INIT</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is why you want to implement game logic and allow users to do things only after information is in place, that is, in <code class="docutils literal notranslate"><span class="pre">AfterPageUpdate(data)</span></code>, which is only called once all information from Psynet has arrived.</p>
<p>As noted, Unity may need, at least once, and sometimes much more than once, to get instructions from PsyNet on how to run the game. This logic is achieved by PsyNet creating ‘silent’ embedded pages, without requiring Unity to restart (which would be painful).</p>
</section>
<section id="communication-from-psynet-to-unity">
<h3>Communication from PsyNet to Unity<a class="headerlink" href="#communication-from-psynet-to-unity" title="Link to this heading">#</a></h3>
<p>The central function in unity here is <code class="docutils literal notranslate"><span class="pre">AfterPageUpdate(data)</span></code>, which is called in the beginning of the game and also (optionally) after communication from Unity to PsyNet was established. It reads a JSON string from the content of the <code class="docutils literal notranslate"><span class="pre">UnityGamePage</span></code> and parses them. In the demo these are:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;goal&quot;</span><span class="o">:</span><span class="w"> </span><span class="nx">goal</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;gain&quot;</span><span class="o">:</span><span class="w"> </span><span class="nx">the_rule</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For this to happen, we need to have a structure in the Unity code that matches that of the PsyNet content, and then we use the standard Unity JSON library to parse, and retrieve the content into the Unity script variable.</p>
<p>In the Settings file you will find the Ucontents serializable class:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Ucontents</span><span class="c1">//DashboardJson</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">goal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">gain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is where you can add variables and structures that must be matched, by both name and type, to those in the PsyNet <code class="docutils literal notranslate"><span class="pre">experiment.py</span></code> content structure we described above. <code class="docutils literal notranslate"><span class="pre">Ucontents</span></code> is contained inside the <code class="docutils literal notranslate"><span class="pre">DashboardJson</span></code> class, which you will not need to change directly:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="na">[Serializable]</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">DashboardJson</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Uattributes</span><span class="w"> </span><span class="n">attributes</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Ucontents</span><span class="w"> </span><span class="n">contents</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, in GameManager we declare a <code class="docutils literal notranslate"><span class="pre">DashboardJson</span></code> object called <code class="docutils literal notranslate"><span class="pre">dashboardJson</span></code>:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="n">DashboardJson</span><span class="w"> </span><span class="n">dashboardJson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DashboardJson</span><span class="p">();</span>
</pre></div>
</div>
<p>And all we need to do in <code class="docutils literal notranslate"><span class="pre">AfterPageUpdate</span></code> is a single line:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">dashboardJson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JsonUtility</span><span class="p">.</span><span class="n">FromJson</span><span class="o">&lt;</span><span class="n">DashboardJson</span><span class="o">&gt;</span><span class="p">(</span><span class="n">jsonData</span><span class="p">);</span>
</pre></div>
</div>
<p>This line will retrieve all your variables into <code class="docutils literal notranslate"><span class="pre">dashboardJson</span></code>.</p>
<p>You can then call these variables like this:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">m_Gain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dashboardJson</span><span class="p">.</span><span class="n">contents</span><span class="p">.</span><span class="n">gain</span><span class="p">;</span>
<span class="n">m_Goal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dashboardJson</span><span class="p">.</span><span class="n">contents</span><span class="p">.</span><span class="n">goal</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="communication-from-unity-to-psynet">
<h3>Communication from Unity to PsyNet<a class="headerlink" href="#communication-from-unity-to-psynet" title="Link to this heading">#</a></h3>
<p>Unity can initiate communication with Psynet at any time by sending a JSON string of variables. Here the important structure is Answer, which is located in the Settings script:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Answer</span><span class="w"> </span><span class="c1">// change name to MetaData</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">score</span><span class="p">,</span><span class="w"> </span><span class="n">reward</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">timeElapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">expire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;This is place holder for comments&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Answer</span></code> class can be used to report any set of game states. In the example above score indicates the current game score and reward indicates the reward rate. In addition we might want to report the time elapsed since the game started and a text answer that can include any free text information. These variables are often used to elicit a response from PsyNet. An example of this is the <code class="docutils literal notranslate"><span class="pre">expire</span></code> boolean variable, which tells Psynet it is time to end the game.</p>
<p>In our demo project all this communication takes place within the function <code class="docutils literal notranslate"><span class="pre">ScoreUp()</span></code>, which is called once the player collected an object:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ScoreUp</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">m_Score</span><span class="o">+=</span><span class="n">m_Gain</span><span class="p">;</span>
<span class="w">    </span><span class="n">score</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Score: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m_Score</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_Score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_Goal</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">answer</span><span class="p">.</span><span class="n">expire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">terminateGame</span><span class="p">.</span><span class="n">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">answer</span><span class="p">.</span><span class="n">score</span><span class="o">=</span><span class="n">m_Score</span><span class="p">;</span>
<span class="w">    </span><span class="n">answer</span><span class="p">.</span><span class="n">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_Gain</span><span class="p">;</span>
<span class="w">    </span><span class="n">StartCoroutine</span><span class="p">(</span><span class="n">WebRequestManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">SubmitPage</span><span class="p">(</span><span class="n">answer</span><span class="p">,</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_SUBMITTTED</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that once PsyNet had received the answer, Psynet might want to talk back, perhaps in order to change game stage or a game rule. At the PsyNet side, this is done by creating a new embedding page (Psynet can do it without interrupting Unity). To test for this, Unity calls the <code class="docutils literal notranslate"><span class="pre">GetPage()</span></code> method after submitting the answer:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AfterPageSubmitted</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">StartCoroutine</span><span class="p">(</span><span class="n">WebRequestManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">Constants</span><span class="p">.</span><span class="n">PAGE_UPDATED</span><span class="p">));</span><span class="w"> </span><span class="c1">// we now get the information from the new page</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now Unity can act upon any changes that Psynet has evoked.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="writing_custom_frontends.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Writing custom frontends</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="experiment_variables.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Experiment variables</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Peter Harrison
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Unity integration</a><ul>
<li><a class="reference internal" href="#running-the-game">Running the game</a></li>
<li><a class="reference internal" href="#developing-and-debugging-the-unity-game">Developing and debugging the Unity game</a><ul>
<li><a class="reference internal" href="#installing-a-unity-psynet-project">Installing a Unity-Psynet project</a></li>
<li><a class="reference internal" href="#understanding-the-psynet-unity-api">Understanding the Psynet Unity API</a></li>
<li><a class="reference internal" href="#how-to-use-psynet-to-drive-a-unity-game">How to use PsyNet to “drive” a Unity game</a></li>
<li><a class="reference internal" href="#game-initiation-logic">Game Initiation logic</a></li>
<li><a class="reference internal" href="#communication-from-psynet-to-unity">Communication from PsyNet to Unity</a></li>
<li><a class="reference internal" href="#communication-from-unity-to-psynet">Communication from Unity to PsyNet</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=bffcfdfb"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/js/custom.js?v=ca86d9ac"></script>
    </body>
</html>